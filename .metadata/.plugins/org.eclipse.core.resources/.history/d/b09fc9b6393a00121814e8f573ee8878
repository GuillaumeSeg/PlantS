package openGL3;
import java.nio.FloatBuffer;
import java.util.Stack;

import javax.vecmath.Matrix3d;
import javax.vecmath.Matrix4f;
import javax.vecmath.Vector3d;
import javax.vecmath.Vector3f;

public class MatrixStack {
	
	private Stack<Matrix4f> m_Stack;
	
	// créé une matrice à la base de la pile et l'initialise à Identité
	public MatrixStack() {
		m_Stack = new Stack<Matrix4f>();
		m_Stack.push(new Matrix4f());
		m_Stack.peek().setIdentity();
	}
	
	// Copie la matrice en tête de pile
	public void push() {
		m_Stack.push(top());
	}
	
	// Retire la matrice en tête de pile
	public void pop() {
		m_Stack.pop();
	}
	
	// renvoie la matrice de tête
	public Matrix4f top() {
		return m_Stack.peek();
	}
	
	public void mult(Matrix4f mat){
		top().mul(mat);
	}

	// Modifie la matrice en tête de pile
	public void set(Matrix4f mat){
		top().set(mat);
	}
	
	// Effectue un scale sur la matrice en tête de pile
	public void scale(float s){
		top().setScale(s);
	}
	
	// Effectue une rotation sur la matrice en tête de pile
	public void rotate(Matrix3d rotate){
		top().setRotation(rotate);
	}
	
	// Effectue une translation sur la matrice en tête de pile
	public void translate(Vector3f translate){
		top().setTranslation(translate);
	}
	
	public float[] topParseToFloatBuffer() {
		int k = 0;
		float[] matrix = new float[12];
		for(int i=0; i<4; ++i) {
			for(int j=0; j<4; ++j) {
				matrix[i + j] = top().getElement(i, j);
			}
		}
		
		return matrix;
	}
	
	public static Matrix3d createRotationMatrix(float alpha, Vector3f dir) {
		return new Matrix3d();
	}
	
	public static Matrix3d createTranslationMatrix(float tx, float ty, float tz) {
		return new Matrix3d(1, 0, 0, 0, 1, 0, tx, ty, tz);
	}
	
	public static Matrix3d createScaleMatrix(float sx, float sy, float sz) {
		return new Matrix3d(sx, 0, 0, 0, sy, 0, 0, 0, sz);
	}


}
